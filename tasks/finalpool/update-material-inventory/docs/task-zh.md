请帮我监听WooCommerce新付款订单，获取订单中每个成品的SKU和数量，然后根据Google Sheets中记录的物料清单(BOM)，计算需要消耗的原材料数量，在Google Sheets的原材料库存表中扣减相应数量，基于更新后的原材料余量，重新计算所有成品的最大可生产数量，将这些最大可生产数量同步到WooCommerce作为产品的可售库存。

## 具体要求

### 1. 订单处理
- 获取WooCommerce的最新付款订单
- 提取每个订单中的成品SKU和购买数量
- 记录订单处理的时间戳和订单ID

### 2. BOM物料清单处理
- 从Google Sheets读取“原材料库存管理测试”表
- 其中BOM工作表包含：成品SKU → 所需原材料 → 每单位用量
- 其中Material_Inventory工作表包含：原材料SKU → 当前库存

### 3. 原材料消耗计算
- 根据订单量和BOM计算每种原材料的总消耗量
- 处理多个不同成品使用相同原材料的聚合计算
- 确保计算的准确性，避免重复计算或遗漏

### 4. 库存更新流程
- 从Google Sheets原材料库存表读取当前库存数量
- 按照计算的消耗量扣减对应的原材料库存
- 将更新后的原材料库存数量写回Google Sheets

### 5. 可生产数量计算
- 基于更新后的原材料库存，计算每个成品的最大可生产数量
- 考虑BOM中每种原材料的约束限制
- 采用最小约束原则：可生产数量 = min(原材料1库存/BOM需求1, 原材料2库存/BOM需求2, ...)

### 6. WooCommerce库存同步
- 将计算出的最大可生产数量同步到WooCommerce
- 更新每个成品在商城中的可售库存数量
- 确保库存信息的实时性和一致性

